# Gradient Descent

* * *

## 미분
* 변화율($f(x+h) - f(x)$)의 극한
* 변수의 움직임에 따른 함수값의 변화를 측정하기 위한 도구 -> 최적화에서 많이 사용
* (x, $f(x)$) 에서의 접선의 기울기를 구할 수 있음.

> <img width="200" alt="image" src="https://user-images.githubusercontent.com/93971443/191641281-08bcd8c8-81ba-4630-a2c8-3aff00a4aff5.png">

* 접선의 기울기를 안다면 점이 어느 방향으로 움직여야 함수값이 증가 / 감소하는지 알 수 있다.
  - 증가 : 점선의 기울기 양/음수 상관없이 더해줌 --> 경사 상승법 --> 함수의 극대값으로 수렴
  - 감소 : 접선의 기울기 양/음수 상관없이 빼줌 --> 경사 하강법 --> 함수의 극소값으로 수렴
  - 경사상승/하강법은 극점에 도달하면 종료됨 --> 미분값이 0이면 더 이상 업데이트가 안되기 때문 

> > <img width="657" alt="image" src="https://user-images.githubusercontent.com/93971443/191642378-9dfa78a6-79be-4dc2-8bce-97c9b06a70f4.png">

* 코드를 통한 미분 계산

<pre>
<code>
import sympy as sym
from sympy.abc import x

sym.diff(sym.poly(x**2 + 2*x + 3),x)
</code>
</pre>


* * *

### 다변량 함수에서의 미분
* 편미분을 통해 각 변수 방향에서의 변화율을 얻는다. --> gradient vector 얻을 수 있음

> <img width="292" alt="image" src="https://user-images.githubusercontent.com/93971443/191642587-6c1a1c22-9d28-440d-8e18-a706faf04743.png">

* 구한 gradient vector를 이용하여 경사하강/상승법에 사용

* * *

### 경사하강법 알고리즘

* 단량 함수
> <pre>
  <code>
  
  var = input # 시작점
  grad = gradient(var)
  while (abs(grad) > eps): # 종료조건
    var = car - lr * grad
    grad = gradient(var)
  </code>
  </pre>
  
* * 코드로 경사하강법 진행시 미분의 컴퓨터 연산이 정확히 0을 갖기 어려움으로 종료 조건을 설정해주어야한다. (eps 활용하여 종료조건 생성)
