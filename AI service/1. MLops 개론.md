# MLOps

* * *
## MLOps란
- ML(machine learning) + Ops(operations)
- 머신러닝 모델을 운영하면서 반복적으로 필요한 업무를 자동화시키는 과정
- 목표 : 머신러닝 모델 개발과 모델 운영에서 사용되는 문제, 반복을 최소화하고 비즈니스 가치를 창출
- 모델링에 집중할 수 있도록 인프라를 만들고 자동으로 운영되도록 함
- production 환경에 배포하는 과정엔 research의 모델 재현 가능해야함(현실의 risk에서 잘 버틸 수 있어야 함)
##### 궁극적으로 빠른 시간 내에 가장 적은 위험을 부담하며 아이디어 단계부터 production 단계까지 ML 프로젝트를 진행할 수 있도록 기술적 마찰을 줄이는 것   


### Research VS. Production
|-|research ML|Production ML|
|:---:|:---:|:---:|
|데이터|고정(static)|계속 변함(Dynamic Shifting)|
|중요 요소|모델 성능(Accuracy, RMSE, etc.) |모델 성능, 빠른 inference 속도, 해석 가능함|
|도전 과제|더 좋은 모델을 내는 모델(SOTA), 새로운 구조의 모델|안정적인 운영, 전제 시스템 구조|
|학습|모델 구조, 파라미터 기반 재학습|시간의 흐름에 따라 데이터가 변경되어 재학습|
|목적|논문 출판|서비스에서 문제 해결|
|표현|offline|online|

* * *

## MLOps Components

* ※ 강의의 타코집 예시를 통해 설명
* 집(= Research) / 가게(= Production) / 음식(= model) / 식재료, 소스, 밀가루 빵(= Data / Feature) / 요리하는 행위(= 모델 train)
##### Server 인프라
- 집에선 그냥 요리하면 되지만 레스토랑을 위해선 __장소__ 가 필요 
- 장소 선정시 고려 사항
  - 유동인구가 얼마나 있는가(= 예상되는 트래픽이 얼마나 되는가?)
  - 가게의 평수(= 서버의 CPU, memory 성능은 어느정도 할 것인가?)
  - 점포 확장이 가능한가(= 스케일 업, 스케일 아웃이 가능한가)
  - 직접 장소를 구입할지? 월세로 사용할지?(= 자체 서버 구축, 클라우드)   
- 레스토랑에서 비싼 식기를 사는 것은 아까울 수 있어 임대하는 경우도 존재(= 클라우드 GPU)   

##### Infra
- 클라우드 : AWS, GCP, Azure, NCP등
- 온 프레미스 : 회사나 대학원의 전산실에 서버를 직접 설치

##### Serving
- 정기 배송처럼 서빙 받길 원할 시 Batch serving(많은 양의 데이터를 주기적으로 예측)
- 만들자마자 실시간 서빙 받길 원할 시 online serving(실시간 예측)

##### Experiment, Model Management
- 집에서 요리할 때, 레시피를 기록해야 어떤 조합이 좋은지 알 수 있음(파라미터, 모델 구조 등)
- 눈대중으로 하는 요리 -> 재현 불가
- 여러 시행착오를 거친 후 best 레시피를 production에서 사용
- 요리 만드는 과정에서 생기는 부산물 저장(= 모델 artifacts, 이미지 등)
- 타코(모델)는 다양한 종류가 있으므로ㅓ 언제 만든 타코인지(= 모델 생성일), 얼마나 맛있었는지(= 모델 성능), 유통기한(= 모델 메타정보)을 기록할 수 있음

##### feature store
- 요리 별로 사용되는 재료들이 중복됨. 반죽이나 간 등을 미리 만들면 편함 -> 시간소요가 적음
- 중복되는 재료를 가공해서 냉장고에 저장(= 머신러닝 feature를 집계한 Feature Store)
- 집이나 레스토랑이나 동일한 재료 사용하도록 구축

##### Data Validation
- 재료들이 예전에 요리할 때 사용한 재료와 비슷한지 확인할 필요가 있음(= feature의 분포 확인)
- research / Production 차이 확인

##### Continuous Training
- 만들었던 요리를 언제부터 고객분들이 좋아하지 않습니다. 신선한 재료로 다시 만듭시다.(Retrain)
- 다시 요리를 하는 경우
  - 신선한 재료가 도착한 경우(= 새로운 데이터)
  - 일정 기간(매일, 매시간...)
  - 갑자기 매출이 줄어들 경우(Metric 기반)
  - 요청시

##### Monitoring
- 레스토랑의 매출, 손님 수, 대기열 등(= 모델이 지표, 인프라의 성능 지표 등)을 잘 기록해야 함.
- 집에서 만든 요리법이 레스토랑에서 얼마나 많이 팔리는 지 확인해서 추가로 아이디어 얻을 수 있음

##### AutoML
- 시대가 좋아져서 자동으로 음식을 만들 수도 있음 => 에어프라이어(AutoML)에 넣기만 하면(집/레스토랑 모두 활용 가능)

#### MLOps Components 정리
- 집에서 요리하던 사람이 레스토랑을 운영하면서 신경써야 하는 부분 = 머신러닝 모델을 직접 운영하면서 신경써야 하는 부분
- MLOps는 회사의 비즈니스 상황과 모델 운영 상황에 따라 우선 순위가 달라짐
- 앞선 모든 요소가 항상 존재해야 하는 것은 아님!!!
- MLOps를 처음부터 진행하는 것이 오히려 비효율적일 수 있음
- MVP(Minival Value Product)로 시작해서 점점 운영 리소스가 많이 소요될 때 하나씩 구축하는 방식을 활용


### ※ 위 내용 및 이미지는 네이버 부스트캠프 교육 자료를 참고하였습니다.

